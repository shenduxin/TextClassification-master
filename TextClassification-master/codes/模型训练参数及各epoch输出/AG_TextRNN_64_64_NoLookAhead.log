Loading data...
Vocab size: 10002
Time usage: 0:00:03
<bound method Module.parameters of Model(
  (embedding): Embedding(10002, 300, padding_idx=10001)
  (lstm): LSTM(300, 128, num_layers=2, batch_first=True, dropout=0.5, bidirectional=True)
  (fc): Linear(in_features=256, out_features=4, bias=True)
)>
Iter:      0,  Train Loss:   1.4,  Train Acc: 25.00%,  Val Loss:   1.4,  Val Acc: 24.97%,  Time: 0:00:00 *
Iter:    100,  Train Loss:   1.4,  Train Acc: 29.69%,  Val Loss:   1.4,  Val Acc: 25.28%,  Time: 0:00:03 *
Iter:    200,  Train Loss:   1.4,  Train Acc: 25.00%,  Val Loss:   1.4,  Val Acc: 25.75%,  Time: 0:00:06 *
Iter:    300,  Train Loss:   1.4,  Train Acc: 26.56%,  Val Loss:   1.4,  Val Acc: 25.48%,  Time: 0:00:09 
Iter:    400,  Train Loss:   1.3,  Train Acc: 37.50%,  Val Loss:   1.3,  Val Acc: 36.67%,  Time: 0:00:12 *
Iter:    500,  Train Loss:   1.4,  Train Acc: 28.12%,  Val Loss:   1.3,  Val Acc: 31.90%,  Time: 0:00:15 
Iter:    600,  Train Loss:   1.2,  Train Acc: 40.62%,  Val Loss:   1.3,  Val Acc: 37.68%,  Time: 0:00:18 *
Iter:    700,  Train Loss:   1.3,  Train Acc: 43.75%,  Val Loss:   1.2,  Val Acc: 40.27%,  Time: 0:00:21 *
Iter:    800,  Train Loss:   1.2,  Train Acc: 40.62%,  Val Loss:   1.2,  Val Acc: 39.10%,  Time: 0:00:24 
Iter:    900,  Train Loss:   1.1,  Train Acc: 40.62%,  Val Loss:   1.2,  Val Acc: 41.80%,  Time: 0:00:27 *
Iter:   1000,  Train Loss:   1.3,  Train Acc: 34.38%,  Val Loss:   1.3,  Val Acc: 31.78%,  Time: 0:00:30 
Iter:   1100,  Train Loss:   1.3,  Train Acc: 35.94%,  Val Loss:   1.3,  Val Acc: 32.18%,  Time: 0:00:33 
Iter:   1200,  Train Loss:   1.3,  Train Acc: 35.94%,  Val Loss:   1.2,  Val Acc: 42.00%,  Time: 0:00:36 
Iter:   1300,  Train Loss:  0.83,  Train Acc: 64.06%,  Val Loss:  0.92,  Val Acc: 55.93%,  Time: 0:00:39 *
Iter:   1400,  Train Loss:  0.71,  Train Acc: 65.62%,  Val Loss:  0.79,  Val Acc: 63.23%,  Time: 0:00:42 *
Iter:   1500,  Train Loss:  0.93,  Train Acc: 59.38%,  Val Loss:  0.73,  Val Acc: 64.88%,  Time: 0:00:44 *
Iter:   1600,  Train Loss:  0.61,  Train Acc: 76.56%,  Val Loss:  0.62,  Val Acc: 75.85%,  Time: 0:00:47 *
Iter:   1700,  Train Loss:  0.49,  Train Acc: 85.94%,  Val Loss:   0.5,  Val Acc: 82.05%,  Time: 0:00:50 *
Iter:   1800,  Train Loss:  0.61,  Train Acc: 78.12%,  Val Loss:  0.46,  Val Acc: 84.25%,  Time: 0:00:53 *
Iter:   1900,  Train Loss:  0.51,  Train Acc: 76.56%,  Val Loss:  0.44,  Val Acc: 84.80%,  Time: 0:00:56 *
Iter:   2000,  Train Loss:   0.5,  Train Acc: 79.69%,  Val Loss:   0.4,  Val Acc: 86.23%,  Time: 0:00:59 *
Iter:   2100,  Train Loss:  0.29,  Train Acc: 92.19%,  Val Loss:  0.36,  Val Acc: 87.57%,  Time: 0:01:02 *
Iter:   2200,  Train Loss:  0.44,  Train Acc: 85.94%,  Val Loss:  0.36,  Val Acc: 87.72%,  Time: 0:01:05 *
Iter:   2300,  Train Loss:   0.2,  Train Acc: 93.75%,  Val Loss:  0.34,  Val Acc: 88.32%,  Time: 0:01:08 *
Iter:   2400,  Train Loss:  0.33,  Train Acc: 90.62%,  Val Loss:  0.34,  Val Acc: 88.22%,  Time: 0:01:11 *
Iter:   2500,  Train Loss:  0.35,  Train Acc: 85.94%,  Val Loss:  0.34,  Val Acc: 88.37%,  Time: 0:01:13 *
Iter:   2600,  Train Loss:  0.28,  Train Acc: 89.06%,  Val Loss:  0.33,  Val Acc: 89.13%,  Time: 0:01:16 *
Iter:   2700,  Train Loss:  0.22,  Train Acc: 92.19%,  Val Loss:  0.34,  Val Acc: 88.10%,  Time: 0:01:19 
Iter:   2800,  Train Loss:  0.36,  Train Acc: 90.62%,  Val Loss:  0.32,  Val Acc: 89.18%,  Time: 0:01:22 *
Iter:   2900,  Train Loss:  0.23,  Train Acc: 92.19%,  Val Loss:  0.32,  Val Acc: 89.23%,  Time: 0:01:25 *
Iter:   3000,  Train Loss:  0.26,  Train Acc: 90.62%,  Val Loss:  0.31,  Val Acc: 89.30%,  Time: 0:01:28 *
Iter:   3100,  Train Loss:  0.28,  Train Acc: 89.06%,  Val Loss:   0.3,  Val Acc: 89.97%,  Time: 0:01:31 *
Iter:   3200,  Train Loss:  0.31,  Train Acc: 87.50%,  Val Loss:   0.3,  Val Acc: 89.70%,  Time: 0:01:34 *
Iter:   3300,  Train Loss:  0.33,  Train Acc: 87.50%,  Val Loss:   0.3,  Val Acc: 89.62%,  Time: 0:01:37 
Iter:   3400,  Train Loss:  0.43,  Train Acc: 89.06%,  Val Loss:   0.3,  Val Acc: 89.67%,  Time: 0:01:40 
Iter:   3500,  Train Loss:  0.36,  Train Acc: 87.50%,  Val Loss:   0.3,  Val Acc: 89.60%,  Time: 0:01:43 *
Iter:   3600,  Train Loss:  0.26,  Train Acc: 87.50%,  Val Loss:   0.3,  Val Acc: 89.33%,  Time: 0:01:46 *
Iter:   3700,  Train Loss:  0.45,  Train Acc: 85.94%,  Val Loss:  0.29,  Val Acc: 89.75%,  Time: 0:01:49 *
Iter:   3800,  Train Loss:  0.19,  Train Acc: 95.31%,  Val Loss:  0.31,  Val Acc: 89.48%,  Time: 0:01:52 
Iter:   3900,  Train Loss:  0.29,  Train Acc: 92.19%,  Val Loss:  0.29,  Val Acc: 89.93%,  Time: 0:01:55 
Iter:   4000,  Train Loss:  0.22,  Train Acc: 92.19%,  Val Loss:  0.29,  Val Acc: 89.92%,  Time: 0:01:58 *
Iter:   4100,  Train Loss:  0.35,  Train Acc: 89.06%,  Val Loss:   0.3,  Val Acc: 89.60%,  Time: 0:02:01 
Iter:   4200,  Train Loss:  0.12,  Train Acc: 96.88%,  Val Loss:  0.28,  Val Acc: 89.95%,  Time: 0:02:04 *
Iter:   4300,  Train Loss:  0.19,  Train Acc: 90.62%,  Val Loss:   0.3,  Val Acc: 89.67%,  Time: 0:02:07 
Iter:   4400,  Train Loss:  0.32,  Train Acc: 89.06%,  Val Loss:  0.31,  Val Acc: 89.23%,  Time: 0:02:10 
Iter:   4500,  Train Loss:  0.31,  Train Acc: 90.62%,  Val Loss:  0.31,  Val Acc: 89.57%,  Time: 0:02:13 
Iter:   4600,  Train Loss:  0.18,  Train Acc: 95.31%,  Val Loss:   0.3,  Val Acc: 89.85%,  Time: 0:02:16 
Iter:   4700,  Train Loss:   0.2,  Train Acc: 92.19%,  Val Loss:   0.3,  Val Acc: 89.82%,  Time: 0:02:19 
Iter:   4800,  Train Loss:  0.38,  Train Acc: 85.94%,  Val Loss:  0.29,  Val Acc: 90.03%,  Time: 0:02:22 
Iter:   4900,  Train Loss:  0.16,  Train Acc: 96.88%,  Val Loss:  0.31,  Val Acc: 89.32%,  Time: 0:02:25 
Iter:   5000,  Train Loss:  0.26,  Train Acc: 95.31%,  Val Loss:   0.3,  Val Acc: 89.88%,  Time: 0:02:28 
Iter:   5100,  Train Loss:  0.17,  Train Acc: 96.88%,  Val Loss:  0.29,  Val Acc: 90.12%,  Time: 0:02:31 
Iter:   5200,  Train Loss:  0.23,  Train Acc: 92.19%,  Val Loss:   0.3,  Val Acc: 89.72%,  Time: 0:02:34 
No optimization for a long time, auto-stopping...
Test Loss:  0.28,  Test Acc: 90.58%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

       World     0.9182    0.8979    0.9079      1900
      Sports     0.9458    0.9732    0.9593      1900
    Business     0.8812    0.8668    0.8740      1900
    Sci/Tech     0.8770    0.8853    0.8811      1900

    accuracy                         0.9058      7600
   macro avg     0.9055    0.9058    0.9056      7600
weighted avg     0.9055    0.9058    0.9056      7600

Confusion Matrix...
[[1706   65   75   54]
 [  25 1849   15   11]
 [  61   21 1647  171]
 [  66   20  132 1682]]
Time usage: 0:00:01
