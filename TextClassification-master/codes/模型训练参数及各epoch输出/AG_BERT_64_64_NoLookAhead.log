Loading data...
Time usage: 0:01:32
<bound method Module.parameters of Model(
  (bert): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(30522, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
  (fc): Linear(in_features=768, out_features=4, bias=True)
)>
Iter:      0,  Train Loss:   1.4,  Train Acc: 20.31%,  Val Loss:   1.4,  Val Acc: 23.78%,  Time: 0:00:09 *
Iter:    100,  Train Loss:  0.38,  Train Acc: 90.62%,  Val Loss:  0.35,  Val Acc: 89.75%,  Time: 0:00:44 *
Iter:    200,  Train Loss:  0.13,  Train Acc: 95.31%,  Val Loss:  0.28,  Val Acc: 90.67%,  Time: 0:01:19 *
Iter:    300,  Train Loss:   0.2,  Train Acc: 93.75%,  Val Loss:  0.24,  Val Acc: 92.02%,  Time: 0:01:54 *
Iter:    400,  Train Loss:  0.25,  Train Acc: 92.19%,  Val Loss:  0.24,  Val Acc: 91.30%,  Time: 0:02:29 *
Iter:    500,  Train Loss:  0.32,  Train Acc: 89.06%,  Val Loss:  0.22,  Val Acc: 92.10%,  Time: 0:03:04 *
Iter:    600,  Train Loss:  0.36,  Train Acc: 90.62%,  Val Loss:  0.23,  Val Acc: 91.90%,  Time: 0:03:38 
Iter:    700,  Train Loss:  0.22,  Train Acc: 90.62%,  Val Loss:  0.21,  Val Acc: 92.65%,  Time: 0:04:13 *
Iter:    800,  Train Loss:  0.27,  Train Acc: 92.19%,  Val Loss:  0.21,  Val Acc: 92.67%,  Time: 0:04:48 *
Iter:    900,  Train Loss:  0.16,  Train Acc: 98.44%,  Val Loss:  0.19,  Val Acc: 93.12%,  Time: 0:05:23 *
Iter:   1000,  Train Loss: 0.086,  Train Acc: 96.88%,  Val Loss:  0.19,  Val Acc: 92.82%,  Time: 0:05:57 
Iter:   1100,  Train Loss:  0.14,  Train Acc: 95.31%,  Val Loss:   0.2,  Val Acc: 92.73%,  Time: 0:06:31 
Iter:   1200,  Train Loss:  0.19,  Train Acc: 93.75%,  Val Loss:   0.2,  Val Acc: 92.77%,  Time: 0:07:05 
Iter:   1300,  Train Loss:  0.11,  Train Acc: 96.88%,  Val Loss:   0.2,  Val Acc: 92.80%,  Time: 0:07:39 
Iter:   1400,  Train Loss:  0.32,  Train Acc: 87.50%,  Val Loss:  0.19,  Val Acc: 93.02%,  Time: 0:08:14 *
Iter:   1500,  Train Loss:  0.28,  Train Acc: 90.62%,  Val Loss:  0.19,  Val Acc: 93.37%,  Time: 0:08:50 *
Iter:   1600,  Train Loss:  0.13,  Train Acc: 95.31%,  Val Loss:   0.2,  Val Acc: 92.93%,  Time: 0:09:24 
Iter:   1700,  Train Loss:  0.21,  Train Acc: 95.31%,  Val Loss:  0.21,  Val Acc: 92.02%,  Time: 0:09:58 
Iter:   1800,  Train Loss:  0.18,  Train Acc: 95.31%,  Val Loss:  0.19,  Val Acc: 93.55%,  Time: 0:10:32 
Iter:   1900,  Train Loss:  0.18,  Train Acc: 95.31%,  Val Loss:  0.19,  Val Acc: 93.28%,  Time: 0:11:05 
Iter:   2000,  Train Loss: 0.094,  Train Acc: 98.44%,  Val Loss:  0.18,  Val Acc: 93.72%,  Time: 0:11:40 *
Iter:   2100,  Train Loss:  0.19,  Train Acc: 90.62%,  Val Loss:  0.18,  Val Acc: 93.40%,  Time: 0:12:14 
Iter:   2200,  Train Loss:  0.08,  Train Acc: 98.44%,  Val Loss:  0.19,  Val Acc: 93.68%,  Time: 0:12:48 
Iter:   2300,  Train Loss: 0.061,  Train Acc: 98.44%,  Val Loss:  0.18,  Val Acc: 93.67%,  Time: 0:13:21 
Iter:   2400,  Train Loss:  0.16,  Train Acc: 93.75%,  Val Loss:  0.18,  Val Acc: 93.43%,  Time: 0:13:56 
Iter:   2500,  Train Loss:  0.15,  Train Acc: 93.75%,  Val Loss:  0.19,  Val Acc: 93.07%,  Time: 0:14:30 
Iter:   2600,  Train Loss:   0.1,  Train Acc: 95.31%,  Val Loss:  0.19,  Val Acc: 93.03%,  Time: 0:15:04 
Iter:   2700,  Train Loss:  0.17,  Train Acc: 93.75%,  Val Loss:   0.2,  Val Acc: 92.87%,  Time: 0:15:37 
Iter:   2800,  Train Loss:  0.19,  Train Acc: 95.31%,  Val Loss:  0.18,  Val Acc: 93.62%,  Time: 0:16:11 
Iter:   2900,  Train Loss: 0.087,  Train Acc: 96.88%,  Val Loss:  0.19,  Val Acc: 93.57%,  Time: 0:16:45 
Iter:   3000,  Train Loss: 0.094,  Train Acc: 95.31%,  Val Loss:  0.19,  Val Acc: 93.37%,  Time: 0:17:19 
No optimization for a long time, auto-stopping...
Test Loss:  0.18,  Test Acc: 94.01%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

       World     0.9619    0.9432    0.9524      1900
      Sports     0.9807    0.9884    0.9845      1900
    Business     0.9100    0.9100    0.9100      1900
    Sci/Tech     0.9084    0.9189    0.9137      1900

    accuracy                         0.9401      7600
   macro avg     0.9402    0.9401    0.9402      7600
weighted avg     0.9402    0.9401    0.9402      7600

Confusion Matrix...
[[1792   18   47   43]
 [   9 1878    6    7]
 [  37    8 1729  126]
 [  25   11  118 1746]]
Time usage: 0:00:10
